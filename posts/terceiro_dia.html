<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<title>terceiro_dia</title><link href='https://fonts.loli.net/css?family=Inconsolata:400,700&subset=latin-ext' rel='stylesheet' type='text/css' /><style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color: #ffffff; --text-color: #333333; --select-text-bg-color: #B5D6FC; --select-text-font-color: auto; --monospace: "Lucida Console",Consolas,"Courier",monospace; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
body { margin: 0px; padding: 0px; height: auto; bottom: 0px; top: 0px; left: 0px; right: 0px; font-size: 1rem; line-height: 1.42857143; overflow-x: hidden; background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; tab-size: 4; background-position: inherit inherit; background-repeat: inherit inherit; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; word-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 40px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
@media screen and (max-width: 500px) { 
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; }
button, input, select, textarea { color: inherit; font-family: inherit; font-size: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-stretch: inherit; line-height: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 2; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.701961); color: rgb(85, 85, 85); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px !important; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right-width: 0px; background-color: inherit; }
.CodeMirror-linenumber { }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; position: relative !important; background-position: inherit inherit; background-repeat: inherit inherit; }
.md-diagram-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; background-position: 0px 0px; background-repeat: initial initial; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print { 
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid-page; break-before: avoid-page; }
  #write { margin-top: 0px; padding-top: 0px; border-color: transparent !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  html.blink-to-pdf { font-size: 13px; }
  .typora-export #write { padding-left: 32px; padding-right: 32px; padding-bottom: 0px; break-after: avoid-page; }
  .typora-export #write::after { height: 0px; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background-color: rgb(204, 204, 204); display: block; overflow-x: hidden; background-position: initial initial; background-repeat: initial initial; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-top-left-radius: 10px; border-top-right-radius: 10px; border-bottom-right-radius: 10px; border-bottom-left-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) { 
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background-color: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; background-position: initial initial; background-repeat: initial initial; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.8; font-family: var(--monospace); }
code { text-align: left; }
a.md-print-anchor { white-space: pre !important; border: none !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; text-shadow: initial !important; background-position: 0px 0px !important; background-repeat: initial initial !important; }
.md-inline-math .MathJax_SVG .noError { display: none !important; }
.html-for-mac .inline-math-svg .MathJax_SVG { vertical-align: 0.2px; }
.md-math-block .MathJax_SVG_Display { text-align: center; margin: 0px; position: relative; text-indent: 0px; max-width: none; max-height: none; min-height: 0px; min-width: 100%; width: auto; overflow-y: hidden; display: block !important; }
.MathJax_SVG_Display, .md-inline-math .MathJax_SVG_Display { width: auto; margin: inherit; display: inline-block !important; }
.MathJax_SVG .MJX-monospace { font-family: var(--monospace); }
.MathJax_SVG .MJX-sans-serif { font-family: sans-serif; }
.MathJax_SVG { display: inline; font-style: normal; font-weight: 400; line-height: normal; zoom: 90%; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; }
.MathJax_SVG * { transition: none; }
.MathJax_SVG_Display svg { vertical-align: middle !important; margin-bottom: 0px !important; margin-top: 0px !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom-width: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
svg[id^="mermaidChart"] { line-height: 1em; }
mark { background-color: rgb(255, 255, 0); color: rgb(0, 0, 0); background-position: initial initial; background-repeat: initial initial; }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
mark .md-meta { color: rgb(0, 0, 0); opacity: 0.3 !important; }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; background-position: inherit inherit; background-repeat: inherit inherit; }
.CodeMirror-scroll { overflow-y: hidden; overflow-x: auto; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right-width: 1px; border-right-style: solid; border-right-color: rgb(221, 221, 221); background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; white-space: nowrap; background-position: inherit inherit; background-repeat: inherit inherit; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; background-position: inherit inherit; background-repeat: inherit inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; background-position: inherit inherit; background-repeat: inherit inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 30px; z-index: 3; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; border: none !important; background-position: 0px 0px !important; background-repeat: initial initial !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; border-width: 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; word-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; background-position: 0px 0px; background-repeat: initial initial; }
.CodeMirror-wrap pre { word-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right-width: 30px; border-right-style: solid; border-right-color: transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right-style: none; width: auto; }
.CodeMirror-linebackground { position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right-style: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background-color: rgba(255, 255, 0, 0.4); background-position: initial initial; background-repeat: initial initial; }
@media print { 
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


@include-when-export url(https://fonts.loli.net/css?family=Inconsolata:400,700&subset=latin-ext);

:root {
  --bg-color: #222;
  --side-bar-bg-color: #5F5F5F;
  --active-file-text-color: #222;
  --text-color: #ebebeb;
  --window-border: 1px solid #606060;
  --active-file-bg-color: rgba(219, 219, 253, 0.4);
  --active-file-text-color: white;
  --control-text-color: #ccc;
}

html, body {
  font-size: 16px;
  color: #ebebeb;
  background: #222;
  background: var(--bg-color);
  font-family: 'Inconsolata', monospace;
}

/* latin-ext */
/* latin */
html.mac-supports-vibrant,
.mac-supports-vibrant body {
  
}

#write {
  padding-left: 10ch;
  padding-right: 10ch;
}
/**
 * ---------------------
 * Block Elements
 */
pre.md-meta-block {
  font-family: monospace;
  color: #DDD;
  padding: 15px;
  background: inherit;
  border: 1px grey dashed;
  font-size: 0.8rem;
  line-height: 1.45;
}
h1,
h2,
h3,
h4,
h5,
h6,
[mdlike='h1'],
[mdlike='h2'],
[mdlike='h3'],
[mdlike='h4'],
[mdlike='h5'],
[mdlike='h6'] {
  font-weight: bold;
  font-family: "PT Mono", monospace;
  color: #dbdbfd;
}
[mdlike='h1'] > .md-blockmeta,
[mdlike='h2'] > .md-blockmeta,
[mdlike='h3'] > .md-blockmeta,
[mdlike='h4'] > .md-blockmeta,
[mdlike='h5'] > .md-blockmeta,
[mdlike='h6'] > .md-blockmeta {
  color: inherit;
  font-weight: inherit;
  font-style: inherit;
}
h1,
[mdlike='h1'] {
  font-size: 2rem;
}
h1:before {
  content: "# ";
}
h2,
[mdlike='h2'] {
  font-size: 1.6rem;
}
h2:before {
  content: "## ";
}
h3,
[mdlike='h3'] {
  font-size: 1.3rem;
}
h3:before,
h3.md-focus:before {
  content: "### ";
}
h4,
h5,
h6,
[mdlike='h4'],
[mdlike='h5'],
[mdlike='h6'] {
  color: #549ad8;
}
h4,
[mdlike='h4'] {
  font-size: 1.2rem;
}
h4:before,
h4.md-focus:before {
  content: "#### ";
}
h5,
[mdlike='h5'] {
  font-size: 1.1rem;
}
h5:before,
h5.md-focus:before {
  content: "##### ";
}
h6,
[mdlike='h6'] {
  font-size: 1rem;
}
h6:before,
h6.md-focus:before {
  content: "####### ";
}
/** override the default style for focused headings */
h3.md-focus:before,
h4.md-focus:before,
h5.md-focus:before,
h6.md-focus:before {
  color: inherit;
  border: inherit;
  border-radius: inherit;
  position: inherit;
  left: initial;
  float: none;
  top: initial;
  font-size: inherit;
  padding-left: inherit;
  padding-right: inherit;
  vertical-align: inherit;
  font-weight: inherit;
  line-height: inherit;
}
table {
  line-height: 1.6rem;
  border-collapse: collapse;
  border-spacing: 0;
  empty-cells: show;
  border: 1px solid #cbcbcb;
}
thead {
  background-color: #263238;
  color: #f5f5f5;
  text-align: left;
  vertical-align: bottom;
}
td,
th {
  border-left: 1px solid #cbcbcb;
  border-width: 0 0 0 1px;
  margin: 0;
  overflow: visible;
  padding: .5em 1em;
}
.md-toc-item {
  position: relative;
}
.md-toc-inner {
  width: 100%;
  display: inline-block;
}
a.md-toc-inner {
  color: #CCC;
}
.md-toc-h2 .md-toc-inner {
  padding-left: 2em;
  margin-left: 0;
}
.md-toc-h3 .md-toc-inner {
  padding-left: 4em;
  margin-left: 0;
}
.md-toc-h4 .md-toc-inner {
  padding-left: 6em;
  margin-left: 0;
}
.md-toc-h5 .md-toc-inner {
  padding-left: 8em;
  margin-left: 0;
}
.md-toc-h6 .md-toc-inner {
  padding-left: 10em;
  margin-left: 0;
}
#write > table {
  width: 100%;
}
#write > h1,
#write > [mdlike='h1'] {
  margin-left: -2ch;
}
#write > h2,
#write > [mdlike='h2'] {
  margin-left: -3ch;
}
#write > h3,
#write > [mdlike='h3'] {
  margin-left: -4ch;
}
#write > h4,
#write > [mdlike='h4'] {
  margin-left: -5ch;
}
#write > h5,
#write > [mdlike='h5'] {
  margin-left: -6ch;
}
#write > h6,
#write > [mdlike='h6'] {
  margin-left: -7ch;
}
#write p {
  margin-top: 1rem;
  margin-bottom: 1rem;
}
#write h1,
#write h2,
#write h3,
#write h4,
#write h5,
#write h6,
#write [mdlike='h1'],
#write [mdlike='h2'],
#write [mdlike='h3'],
#write [mdlike='h4'],
#write [mdlike='h5'],
#write [mdlike='h6'] {
  margin-top: 0.83em;
  margin-bottom: 0.83em;
}
@media (min-width: 800px) {
  .pin-outline #write {
    padding-left: 10ch;
    padding-right: 6ch;
  }

  #write {
    padding-left: 12ch;
    padding-right: 12ch;
  }
  #write > h6,
  #write > p [mdlike='h6'] {
    margin-left: -8ch;
  }
}
@media (max-width: 1200px) {
  .pin-outline #write {
    padding-left: 10ch;
    padding-right: 8ch;
  }

  .pin-outline #write > h1,
  .pin-outline #write > h2,
  .pin-outline #write > h3,
  .pin-outline #write > h4,
  .pin-outline #write > h5,
  .pin-outline #write > h6,
  .pin-outline #write > p [mdlike='h1'],
  .pin-outline #write > p [mdlike='h2'],
  .pin-outline #write > p [mdlike='h3'],
  .pin-outline #write > p [mdlike='h4'],
  .pin-outline #write > p [mdlike='h5'],
  .pin-outline #write > p [mdlike='h6'] {
    margin-left: 0;
  }
}
@media (max-width: 600px) {
  .pin-outline #write {
    padding-left: 4ch;
    padding-right: 4ch;
  }

  #write {
    padding-left: 4ch;
    padding-right: 4ch;
  }
  #write > h1,
  #write > h2,
  #write > h3,
  #write > h4,
  #write > h5,
  #write > h6,
  #write > p [mdlike='h1'],
  #write > p [mdlike='h2'],
  #write > p [mdlike='h3'],
  #write > p [mdlike='h4'],
  #write > p [mdlike='h5'],
  #write > p [mdlike='h6'] {
    margin-left: 0;
  }
}
ul[cid] {
  list-style-type: none;
}
ul[cid] li:before {
  content: "*";
  margin-left: -3ch;
  position: absolute;
  color: #4fac4f;
}
ul[data-mark="-"] > li:before {
  content: "-";
}
ul[data-mark="+"] > li:before {
  content: "+";
}
.task-list > li:before {
  margin-left: -6ch;
}
ol[cid] {
  counter-reset: item;
  list-style-type: none;
}
ol[cid] > li:before {
  content: counter(item) ". ";
  counter-increment: item;
  color: #4fac4f;
  margin-left: -2ch;
  position: absolute;
}
.task-list-item input:before {
  content: '[ ]';
  display: inline-block;
  margin-left: -2ch;
  width: 4ch;
  position: absolute;
  top: -1px;
  vertical-align: middle;
  text-align: center;
  background-color: #222;
  color: #4fac4f;
}
.task-list-item input:checked:before {
  content: '[x]';
}
.task-list-item input:checked ~ * {
  text-decoration: line-through;
}
blockquote {
  background-color: rgba(128, 128, 128, 0.05);
  border-top-right-radius: 5px;
  border-bottom-right-radius: 5px;
  padding: 0 20px;
  border-left: 8px solid #979797;
}
hr {
  position: relative;
  height: 20px;
  font-size: 0;
  line-height: 0;
  overflow: hidden;
  border: 0;
  margin-bottom: 20px;
}
hr:after {
  content: "--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------";
  position: absolute;
  top: 0;
  left: 0;
  font-size: 14px;
  line-height: 20px;
  width: 100%;
  word-wrap: break-word;
}
/**
 * Code Fences
 */
.md-fences:not(.md-fences-with-lineon) .cm-s-inner {
  padding-left: 8px;
}
.CodeMirror.cm-s-inner {
  padding-top: 8px;
  border-radius: 3px;
  padding-bottom: 16px;
}
.CodeMirror.cm-s-inner .CodeMirror-gutters {
  background: #263238;
  color: #537f7e;
  border: none;
}
.CodeMirror .CodeMirror-guttermarker,
.CodeMirror.cm-s-inner .CodeMirror-guttermarker,
.CodeMirror .CodeMirror-guttermarker-subtle,
.CodeMirror.cm-s-inner .CodeMirror-guttermarker-subtle,
.CodeMirror .CodeMirror-linenumber,
.CodeMirror.cm-s-inner .CodeMirror-linenumber {
  color: #537f7e;
}
.CodeMirror .CodeMirror-cursor,
.CodeMirror.cm-s-inner .CodeMirror-cursor {
  border-left: 1px solid #f8f8f0;
}
.CodeMirror div.CodeMirror-selected,
.CodeMirror.cm-s-inner div.CodeMirror-selected {
  background: rgba(255, 255, 255, 0.15);
}
.CodeMirror .CodeMirror-focused div.CodeMirror-selected,
.CodeMirror.cm-s-inner .CodeMirror-focused div.CodeMirror-selected {
  background: rgba(255, 255, 255, 0.1);
}
.CodeMirror .CodeMirror-line::selection,
.CodeMirror.cm-s-inner .CodeMirror-line::selection,
.CodeMirror .CodeMirror-line > span::selection,
.CodeMirror.cm-s-inner .CodeMirror-line > span::selection,
.CodeMirror .CodeMirror-line > span > span::selection,
.CodeMirror.cm-s-inner .CodeMirror-line > span > span::selection {
  background: rgba(255, 255, 255, 0.1);
}
.CodeMirror .CodeMirror-line::-moz-selection,
.CodeMirror.cm-s-inner .CodeMirror-line::-moz-selection,
.CodeMirror .CodeMirror-line > span::-moz-selection,
.CodeMirror.cm-s-inner .CodeMirror-line > span::-moz-selection,
.CodeMirror .CodeMirror-line > span > span::-moz-selection,
.CodeMirror.cm-s-inner .CodeMirror-line > span > span::-moz-selection {
  background: rgba(255, 255, 255, 0.1);
}
.CodeMirror .CodeMirror-activeline-background,
.CodeMirror.cm-s-inner .CodeMirror-activeline-background {
  background: rgba(0, 0, 0, 0);
}
.CodeMirror .cm-keyword,
.CodeMirror.cm-s-inner .cm-keyword {
  color: #c792ea;
}
.CodeMirror .cm-operator,
.CodeMirror.cm-s-inner .cm-operator {
  color: #e9eded;
}
.CodeMirror .cm-variable-2,
.CodeMirror.cm-s-inner .cm-variable-2 {
  color: #80CBC4;
}
.CodeMirror .cm-variable-3,
.CodeMirror.cm-s-inner .cm-variable-3 {
  color: #82B1FF;
}
.CodeMirror .cm-builtin,
.CodeMirror.cm-s-inner .cm-builtin {
  color: #DECB6B;
}
.CodeMirror .cm-atom,
.CodeMirror.cm-s-inner .cm-atom {
  color: #ceb6b8;
}
.CodeMirror .cm-number,
.CodeMirror.cm-s-inner .cm-number {
  color: #ceb6b8;
}
.CodeMirror .cm-def,
.CodeMirror.cm-s-inner .cm-def {
  color: #e9eded;
}
.CodeMirror .cm-string,
.CodeMirror.cm-s-inner .cm-string {
  color: #C3E88D;
}
.CodeMirror .cm-string-2,
.CodeMirror.cm-s-inner .cm-string-2 {
  color: #80CBC4;
}
.CodeMirror .cm-comment,
.CodeMirror.cm-s-inner .cm-comment {
  color: #546E7A;
}
.CodeMirror .cm-variable,
.CodeMirror.cm-s-inner .cm-variable {
  color: #ebebeb;
}
.CodeMirror .cm-tag,
.CodeMirror.cm-s-inner .cm-tag {
  color: #f76764;
}
.CodeMirror .cm-meta,
.CodeMirror.cm-s-inner .cm-meta {
  color: #DDD;
}
.CodeMirror .cm-attribute,
.CodeMirror.cm-s-inner .cm-attribute {
  color: #8888fd;
}
.CodeMirror .cm-property,
.CodeMirror.cm-s-inner .cm-property {
  color: #ebebeb;
}
.CodeMirror .cm-qualifier,
.CodeMirror.cm-s-inner .cm-qualifier {
  color: #DECB6B;
}
.CodeMirror .cm-variable-3,
.CodeMirror.cm-s-inner .cm-variable-3 {
  color: #DECB6B;
}
.CodeMirror .cm-tag,
.CodeMirror.cm-s-inner .cm-tag {
  color: #ff5370;
}
.CodeMirror .cm-header,
.CodeMirror.cm-s-inner .cm-header,
.CodeMirror .cm-header,
.CodeMirror.cm-s-inner .cm-header {
  color: #b6e6ff;
}
.CodeMirror .cm-error,
.CodeMirror.cm-s-inner .cm-error {
  color: #ffffff;
  background-color: #EC5F67;
}
.CodeMirror .cm-link,
.CodeMirror.cm-s-inner .cm-link {
  color: #B2B2E0;
}
.cm-s-inner {
  background-color: #263238;
  color: #e9eded;
}
.cm-s-inner .CodeMirror-matchingbracket {
  text-decoration: underline;
  color: white !important;
}
/**apply to code fences with plan text**/
.md-fences {
  background: #263238;
  color: #e9eded;
  border: none;
  overflow-x: visible;
  white-space: pre;
  border-radius: 3px;
  padding-top: 4px;
  padding-bottom: 4px;
}
.md-fences .CodeMirror.cm-s-inner:before {
  content: "``` " attr(lang);
}
.md-fences .CodeMirror-scroll:after {
  content: " ";
}
.md-fences .CodeMirror.cm-s-inner:after {
  content: "```";
  bottom: 0;
  z-index: 99;
}
.md-fences .code-tooltip {
  background-color: #263238;
}
/**
 * Inline Elements
 */
code {
  color: #caca16;
  font-size: 0.9em;
}
mark {
  background: bisque;
}
strong {
  color: #ffffc5;
}
em {
  color: #c885f5;
}
a {
  color: #8ac9ff;
}
#write a:hover {
  background-color: #2a6496;
  color: white;
  text-decoration: none;
}
.md-meta,
.md-content {
  display: inline;
}
#typora-source .cm-header {
  font-weight: bold;
  font-family: "PT Mono", monospace;
  color: #dbdbfd;
  font-size: 1rem;
  line-height: 1rem;
}
#typora-source .cm-strong {
  color: #ffffc5;
}
#typora-source .cm-em {
  color: #c885f5;
}
#typora-source .cm-link {
  color: #8ac9ff;
}
#typora-source .cm-string {
  color: #5b808d;
}
#typora-source .cm-comment {
  color: #caca16;
}
/*
 * Electron UI
 */
.outline-item:hover {
  background-color: #333;
  color: white;
  border-color: #333;
}
#write div.md-toc-tooltip {
  background-color: #222;
}
.btn,
.btn .btn-default {
  background: transparent;
  color: #b8bfc6;
}
.md-table-edit {
  border-top: 1px solid gray;
  background-color: #363B40;
}
.popover-title {
  background: transparent;
}
.context-menu {
  border-radius: 0;
}
.context-menu.dropdown-menu > li > a:hover,
.context-menu.dropdown-menu > li > a:focus {
  background-color: inherit;
}
.context-menu.dropdown-menu .divider {
  background-color: #777777;
}
.btn {
  color: #fff;
  letter-spacing: 1px;
  text-decoration: none;
  white-space: nowrap;
  background-color: #444449;
  border-radius: 5px;
  cursor: pointer;
  box-sizing: border-box;
}
.btn:hover,
.btn:focus,
#footer-word-count:hover,
.show-word-count #footer-word-count,
.mouse-entered .footer-btn:hover {
  color: #fff;
  border-color: #777;
  background-color: #777;
  outline: 0;
}
#outline-btn,
#outline-btn:hover .ion-android-radio-button-on {
  color: white;
}
.btn.btn-primary {
  color: #FFF;
  background-color: #777;
  border-color: #777;
}
.btn.btn-primary:hover {
  color: #FFF;
  background-color: #428bca;
  border-color: #428bca;
}
.mouse-entered #top-titlebar .toolbar-icon.btn:hover {
  background-color: #777777;
  color: #f5f5f5;
}
#md-searchpanel,
#md-notification {
  left: 0;
}
#md-searchpanel,
#md-notification,
.on-search-panel-open header,
.modal-content,
.popover,
.dropdown-menu,
.megamenu-menu,
#outline-dropmenu,
.typora-node #outline-dropmenu {
  background-color: #42464A;
}
.popover.bottom > .arrow:after {
  border-bottom-color: #42464A;
}
#md-notification {
  color: #ddd;
}
.typora-node #outline-dropmenu {
  border-right: 1px solid #555;
}
.info-panel-tab.active,
.info-panel-tab.active:hover,
.info-panel-tab:hover {
  color: #ddd;
}
.menu-style-btn.active,
.context-menu.dropdown-menu > .active > a,
.context-menu.dropdown-menu > li > a:hover {
  background-color: #777777;
  color: white;
}
.form-control:focus {
  color: #999;
}
.input-group-addon {
  padding-right: 16px;
}
input,
input.form-control {
  border-radius: 0;
  background-color: transparent;
  border: 1px solid #ccc;
  color: inherit;
}
.dropdown-menu .menu-item-container a.menu-style-btn:not(.menu-style-btn-2width) {
  width: calc(25% - 2.5px);
}
#w-unpin {
  color: #222;
}
.dropdown-menu .divider {
  background-color: #999;
}
#footer-word-count-info {
  bottom: 28px;
}
#megamenu-content,
.megamenu-opened header {
  background-color: #222;
  background: #222;
}
.md-expand.md-image > .md-meta {
  background-color: rgba(219, 219, 219, 0.86);
}
@media (min-width: 1000px) {
  .ty-footer {
    background-color: inherit;
  }
}

.md-image>.md-meta {
  color: #b5adcd;
  background-color: rgba(190, 190, 190, 0.37);
}

.md-expand.md-image > .md-meta {
  color: #5f5b6c;
}

#typora-sidebar {
  background: transparent;
}

.html-for-mac #typora-sidebar {
  border-right: none;
}

content,
titlebar {
  background: var(--bg-color);
}

.sidebar-footer {
  background: #222;
  border-top: 1px transparent solid;
}

.file-list-item,
.sidebar-tabs {
  border-top: none;
  border-bottom: none;
}

.ty-side-sort-btn.active {
  background: var(--bg-color);
}

.file-node-content:hover {
  color: white;
}

.md-task-list-item>input {
  margin-top: calc(1rem - 12px);
}



</style>
</head>
<body class='typora-export' >
<div  id='write'  class = 'is-mac'><p><em><span>Leia ouvindo</span></em></p><iframe src="https://open.spotify.com/embed/track/3a6PN6BRB8PP3ms48s7kU1" width="300" height="80" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe><h2><a name="x86-refresher-pt-3" class="md-header-anchor"></a><span>x86 refresher pt. 3</span></h2><p><strong><span>Hoje é dia de entender a outra parte do código ♪☆＼(^０^＼) ♪(／^-^)／☆♪</span></strong></p><p><span>Não sei se leram/lembram, mas no último post paramos entendendo o que eram as &quot;sections&quot; que declaramos. Quick flashback:</span></p><p><span>  </span><img src="https://nutc4k3.github.io/imgs/segmentos.png" alt="segmentos" width="450" height="400" /></p><p>&nbsp;</p><p><span>Bora entender o resto então :) Da uma olhada no código de novo. Vamos reescrevê-lo agora pensando em cada partezinha. Se a gente for pensando em estruturação do código, ele começa assim:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="assembly"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="assembly"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 28px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><span><span>​</span>x</span></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">; eu sou um comentario</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">; primeiro eu declaro os segmentos que eu vou trabalhar:</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">section</span> <span class="cm-builtin">.text</span> <span class="cm-comment">; o segmento text para conter o meu codigo executavel</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">section</span> <span class="cm-builtin">.data</span> <span class="cm-comment">; o segmento de dados para conter as minhas variaveis inicializadas</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 100px;"></div><div class="CodeMirror-gutters" style="display: none; height: 100px;"></div></div></div></pre><p><strong><span>Importante</span></strong></p><p><span>Uma coisa que eu esqueci de comentar no último post é que você não está aprendendo a linguagem universal do assembly! É, eu enganei vocês hehe brincadeirinha, mas é que não só ele é específico para cada geração/família, mas ele também tem suas particularidades por assembler... A sintaxe que estamos usando é particular do The Netwide Assembler (</span><em><span>nasm</span></em><span>), se estivessemos pensando em outros assemblers como </span><em><span>yasm</span></em><span> ou </span><em><span>fasm</span></em><span> veríamos uma sintaxe um pouquinho diferente. Ou seja, vocês não estão aprendendo &quot;IA-32&quot;, mas sim:</span></p><blockquote><p><span>A Lógica Assembly para os processadores da Intel 32-bit com a sintaxe do The Netwide Assembler ou o famoso </span><strong><span>nasm x86 assembly</span></strong></p></blockquote><p><img src="https://nutc4k3.github.io/imgs/patrick.gif" alt="patrick"  width="250" height="200"  /><span> </span></p><p><span>Logo, esse será um grande amigo nessa jornada: </span><a href='https://www.nasm.us/doc/'><span>The Netwide Assembler Manual</span></a><span> ヅ</span></p><p><span>Então as &quot;sections&quot; que escrevemos ali em cima, na verdade, vieram daqui: </span><a href='https://www.nasm.us/xdoc/2.09.04/html/nasmdoc7.html' target='_blank' class='url'>https://www.nasm.us/xdoc/2.09.04/html/nasmdoc7.html</a></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="assembly "><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="assembly "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 28px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">global</span> <span class="cm-builtin">_start</span> <span class="cm-comment">; diretiva nasm apontando para o símbolo</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">section</span> <span class="cm-builtin">.text</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">_start</span>: <span class="cm-comment">; símbolo/label global</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">section</span> <span class="cm-builtin">.data</span> </span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 100px;"></div><div class="CodeMirror-gutters" style="display: none; height: 100px;"></div></div></div></pre><p><code>global</code><span> é uma </span><a href='https://www.nasm.us/xdoc/2.13/html/nasmdoc6.html'><span>diretiva nasm</span></a><span>. A diretiva exporta o símbolo que foi definido em código de objeto. O linker </span><code>ld</code><span> lerá esse símbolo e o seu valor no arquivo de código de objeto. Em seguida, ele define onde colocar esse símbolo no executável final. Então essas diretivas na verdade são como &quot;anotações&quot; que o assembler deixa para o linker &quot;marcar&quot; no código final. Vamo lá, de novo rs:</span></p><ol><li><span>Marcamos o símbolo </span><code>_start</code><span> como global usando o assembler </span><em><span>nasm</span></em><span>. Poderíamos marcar qualquer coisa, só teríamos declarar ele no linker, assim: </span><code>ld -e qualquercoisa -o helloworld helloworld.o</code></li><li><code>_start</code><span> é como se fosse o main() da Linguagem C. Ele vai guiar o fluxo da execução dizendo &quot;opa, começa por mim!!!&quot;.</span></li><li><span>O linker consegue ler o símbolo </span><code>_start</code><span> e o seu valor no código de objeto (helloworld.o)  e ele &quot;escreve&quot;, da mesma forma no executável final (helloworld.out ou </span><code>helloworld</code><span>) como onde a execução do programa deve começar.</span></li></ol><p><span>Beleza, estamos avançando </span><img src="https://nutc4k3.github.io/imgs/squirtle.gif" alt="squirtle"  width="150" height="150"  /><span> hehe</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="assembly "><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="assembly "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 28px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">global</span> <span class="cm-builtin">_start</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">section</span> <span class="cm-builtin">.text</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">_start</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">section</span> <span class="cm-builtin">.data</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">; vamos comecar declarando o nosso texto usando "db" ou define byte e a label message</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag">message:</span> db <span class="cm-string">"Hello World!"</span> </span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 140px;"></div><div class="CodeMirror-gutters" style="display: none; height: 140px;"></div></div></div></pre><p><code>message</code><span> aqui, é uma label, ela poderia se chamar qualquecoisa se eu quisesse... </span></p><p><code>db</code><span> (define byte) segundo a seção </span><a href='https://www.nasm.us/doc/nasmdoc3.html#section-3.2.4'><span>declarando dados inicializados</span></a><span> define byte por byte da frase &quot;Hello World&quot;. Alguns exemplos tirados do manual:</span></p><blockquote><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang=""><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 28px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  db &nbsp;  0x55 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ; just the byte 0x55 </span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  db &nbsp;  0x55,0x56,0x57 &nbsp; &nbsp;  ; three bytes in succession </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  db &nbsp;  'a',0x55 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ; character constants are OK </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  db &nbsp;  'hello',13,10,'$' &nbsp; ; so are string constants </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  dw &nbsp;  0x1234 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ; 0x34 0x12 </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  dw &nbsp;  'a' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; 0x61 0x00 (it's just a number) </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  dw &nbsp;  'ab' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ; 0x61 0x62 (character constant) </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  dw &nbsp;  'abc' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; 0x61 0x62 0x63 0x00 (string) </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  dd &nbsp;  0x12345678 &nbsp; &nbsp; &nbsp; &nbsp;  ; 0x78 0x56 0x34 0x12 </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  dd &nbsp;  1.234567e20 &nbsp; &nbsp; &nbsp; &nbsp; ; floating-point constant </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  dq &nbsp;  0x123456789abcdef0  ; eight byte constant </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  dq &nbsp;  1.234567e20 &nbsp; &nbsp; &nbsp; &nbsp; ; double-precision float </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  dt &nbsp;  1.234567e20 &nbsp; &nbsp; &nbsp; &nbsp; ; extended-precision float</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 260px;"></div><div class="CodeMirror-gutters" style="display: none; height: 260px;"></div></div></div></pre></blockquote><p><span>Até agora apenas inicializamos variáveis e &quot;marcamos&quot; como ele será usado na memória, mas não escrevemos nenhum código executável ainda! Para isso precisamos conhecer um mecanismo importantíssimo: as </span><a href='http://articles.manugarg.com/systemcallinlinux2_6.html'><span>system calls</span></a><span>.</span></p><p><span>O objetivo do nosso código hello world é escrever na nossa interface de comando a frase &quot;Hello World&quot;, certo? Ou seja, podemos dizer que queremos </span><em><span>escrever</span></em><span> os caracteres &quot;&quot;&#39;h&#39;, &#39;e&#39;...&quot; na </span><em><span>stdout</span></em><span> e depois </span><em><span>terminar</span></em><span> o programa </span><em><span>gracefully</span></em><span>. Toda vez que eu escuto </span><a href='https://en.wikipedia.org/wiki/Graceful_exit'><strong><span>exit the program gracefully</span></strong></a><span> eu imagino o programa mais ou menos assim:</span></p><p><img src="https://nutc4k3.github.io/imgs/thiisok.gif" referrerpolicy="no-referrer" alt="thiisok"></p><p>&nbsp;</p><p><span>As </span><strong><span>syscalls</span></strong><span> fornecem aos processos da </span><em><span>userland</span></em><span>(lembra do User Space? Ele fica na User Land :v) uma maneira de solicitar serviços do kernel. Que tipo de serviços? Serviços gerenciados pelo sistema operacional, como armazenamento, memória, rede, gerenciamento de processos etc. Por exemplo, se um processo do usuário quiser ler um arquivo, ele terá que fazer uma chamada ao sistema para </span><code>open</code><span> e para </span><code>read</code><span>. </span></p><p><em><span>Disclaimer</span></em><span> Você não precisa do uso de uma syscall para escrever &quot;Hello World&quot; na tela, se tivermos operando em protected mode, podemos alocar a frase diretamento no espaco da RAM para video, como nesse </span><a href='https://wiki.osdev.org/Babystep4'><span>código</span></a><span> que, inclusive, eu recomendo a wiki como um todo! &lt;3 Mas, por motivos de conforto, vamos usar nossas syscalls &lt;3</span></p><p><span>Eu gosto muito dos desenhos da </span><a href='https://twitter.com/b0rk'><span>Julia Evans</span></a><span>, ela tem </span><a href='https://twitter.com/b0rk/status/989011990092963840'><span>esses</span></a><span> quadrinhos explicando syscalls, mas eles estão em inglês :( Maaaas a 9dads é que ela tá pedindo ajuda! Então se quiser ajudar, esse é o repositório: </span><a href='https://github.com/jvns/zine-translations/tree/master/brazilian-portuguese' target='_blank' class='url'>https://github.com/jvns/zine-translations/tree/master/brazilian-portuguese</a><span> </span></p><p><span>Thank You Julia! </span><img src="https://nutc4k3.github.io/imgs/thanks.gif" alt="thanks"  width="200" height="200" /></p><p>&nbsp;</p><p><span>Existem alguns mecanismos para chamar syscalls. As três permitem interagir com o kernel pedindo para realizar rotinas, mas cada um de um jeito diferente:</span></p><ul><li><code>int 0x80</code><span> </span></li></ul><ul><li><code>sysenter</code></li><li><code>vdso</code></li></ul><p><span>Digamos que </span><code>int 0x80</code><span> &lt; </span><code>sysenter</code><span> &lt; </span><code>vdso</code><span>, porém algumas pessoas podem se ofender com essa afirmação rs, só que eu não acho que vem ao caso discutir isso aqui... Por hora devemos saber que </span><code>int 0x80</code><span> é a syscall mais &quot;legada&quot;, porém é muito comum ver ela em trilhões de códigos in the wild, por isso é bacana nos acostumarmos com ela.</span></p><p><span>Detalhe </span><code>int 0x80</code><span> não é de </span><em><span>inteiro com valor 0x80</span></em><span>, mas sim </span><code>int</code><span> de interrupt e </span><code>0x80</code><span> é o número do interrupt vector programado para syscalls. Da pra ler melhor </span><a href='https://stackoverflow.com/questions/1817577/what-does-int-0x80-mean-in-assembly-code/1817604#1817604'><span>aqui</span></a></p><p><img src="https://nutc4k3.github.io/imgs/syscalls.png" alt="syscalls"  width="925" height="300" /><span> </span></p><p><span>Para saber as syscalls suportadas no seu sistema você precisa do google ou de algum manual do seu OS, no caso do Ubuntu que estou usando, encontramos em </span><code>/usr/include/i386-linux-gnu/asm/unistd_32.h</code><span> e ela se parece assim:</span></p><p><img src="https://nutc4k3.github.io/imgs/image-20200421163017907.png" alt="image-20200421163017907"  width="600" height="400"  /></p><p><span>Vamos entender a tabela:</span></p><ul><li><code>#define</code><span> diretiva da linguagem C que define como constante alguma coisa</span></li></ul><ul><li><code>__NR_restart_syscall</code><span> &quot;__NR_XXX&quot; vem de </span><em><span>Numeric Reference</span></em><span> e é uma macro para a chamada XXX</span></li></ul><ul><li><code>0</code><span> número da syscall </span><strong><span>importante</span></strong><span> </span></li></ul><p><span>Sabendo disso, vamos procurar as syscalls do nosso código, lembra que montamos uma frase com o nosso objetivo? Não? Essa aqui oh:</span></p><blockquote><p><span>&quot;[...] queremos </span><em><span>escrever</span></em><span> os caracteres &quot;&quot;&#39;h&#39;, &#39;e&#39;...&quot; na </span><em><span>stdout</span></em><span> e depois </span><em><span>terminar</span></em><span> o programa </span><em><span>gracefully</span></em><span>&quot;</span></p></blockquote><p><span>Analisando a frase, conseguimos entender que temos duas ações (verbos) e dois valores (substantivo/adjetivo):</span></p><p><em><span>escrever</span></em><span> (ação) --&gt; </span><em><span>na stdout</span></em><span> (valor)</span></p><p><em><span>terminar</span></em><span> (ação) --&gt; </span><em><span>gracefully</span></em><span> (valor)</span></p><p><span>As ações, nesse caso, podem ser considerados como syscalls, vamos encontrá-las no nosso arquivo:</span></p><p><img src="https://nutc4k3.github.io/imgs/grep.png" alt="grep"  width="900" height="250" /></p><p><span>Ou seja, aqui, </span><code>write</code><span> == 4 e </span><code>exit</code><span> == 1</span></p><p><span>Podemos avançar um pouco no nosso código com essa informação</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="assembly"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="assembly"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 28px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">global</span> <span class="cm-builtin">_start</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">section</span> <span class="cm-builtin">.text</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">_start</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">; chama a syscall de escrita</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-keyword">mov</span> <span class="cm-variable-2">eax</span>, 4</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" class="cm-tab-wrap-hack" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-comment">; chama a syscall de término do programa</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-keyword">mov</span> <span class="cm-variable-2">eax</span>, 1</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">section</span> <span class="cm-builtin">.data</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tag">message:</span> db <span class="cm-string">"Hello World!"</span> </span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 220px;"></div><div class="CodeMirror-gutters" style="display: none; height: 220px;"></div></div></div></pre><p><span>Hmmmm, legal, mas e onde eu coloco meus valores? e o que é esse </span><code>eax</code><span>?? </span></p><p><span> </span><img src="https://nutc4k3.github.io/imgs/confusedcat.gif" alt="confusedcat"  width="200" height="200" /></p><p><span>No Linux, ao usarmos o mecanismo </span><code>int 0x80</code><span> devemos seguir uma &quot;regra&quot; que é seguida de dois passos:</span></p><p>&nbsp;</p><p><strong><span>Primeiro</span></strong><span> consultamos a ordem dos argumentos da syscall </span><code>write</code><span>. </span></p><p><span>Para isso, usamos o </span><em><span>Linux Programmer Manual</span></em><span> usando o comando </span><code>man 2 write</code><span>* no seu ubuntu ou podemos consultar </span><a href='https://syscalls.kernelgrok.com/'><span>aqui</span></a><span>. </span></p><ul><li><code>man</code><span> (manual) </span><code>2</code><span> (seção 2 do </span><a href='https://www.kernel.org/doc/man-pages/'><span>manual</span></a><span>) e </span><code>write</code><span> (nome da syscall).</span></li></ul><p><span>Das duas maneiras obtemos:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="c"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="c"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 28px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ssize_t</span> <span class="cm-def">write</span>(<span class="cm-variable-3">int</span> <span class="cm-variable">fd</span>, <span class="cm-keyword">const</span> <span class="cm-variable-3">void</span> <span class="cm-variable-3">*</span><span class="cm-variable">buf</span>, <span class="cm-variable-3">size_t</span> <span class="cm-variable">count</span>);</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 20px;"></div><div class="CodeMirror-gutters" style="display: none; height: 20px;"></div></div></div></pre><p><span>com a descrição sendo:</span></p><blockquote><p><span>&quot;write() writes up to </span><em><span>count</span></em><span> bytes from the buffer starting at </span><em><span>buf</span></em><span> to the file referred to by the file descriptor </span><em><span>fd</span></em><span>.&quot; - </span><a href='http://man7.org/linux/man-pages/man2/write.2.html' target='_blank' class='url'>http://man7.org/linux/man-pages/man2/write.2.html</a></p></blockquote><p><span>Traduzindo... a syscall </span><code>write</code><span> escreve a quantidade de bytes descrita em </span><em><span>count</span></em><span>, começando pelo </span><em><span>buf</span></em><span> para o arquivo descrito em </span><em><span>fd</span></em></p><p><span>Pra quem não lembra, os file descriptors </span><em><span>fd</span></em><span> podem ser:</span></p><ul><li><span>stdin  --&gt; 0</span></li></ul><ul><li><span>stout  --&gt; 1</span></li></ul><ul><li><p><span>stderr --&gt; 2</span></p><p>&nbsp;</p></li></ul><p><strong><span>Segundo</span></strong><span> seguimos a seguinte ordem de registradores:</span></p><ul><li><span>EAX --&gt; syscall number</span></li><li><span>EBX --&gt; primeiro argumento</span></li><li><span>ECX --&gt; segundo argumento</span></li><li><span>EDX --&gt; terceiro argumento</span></li><li><span>ESI --&gt; quarto argumento</span></li><li><span>EDI --&gt; quinto argumento</span></li></ul><p><em><span>Detalhe Importante</span></em><span> os valores inteiros e endereços de memória sempre serão &quot;guardados&quot; no registrador EAX quando houver uma instrução </span><code>call</code><span>. Isso não é Universal, apenas uma </span><a href='https://en.wikipedia.org/wiki/X86_calling_conventions'><span>conveção</span></a><span> para assembly x86.</span></p><p><span>Bom, então temos algumas informações novas:</span></p><ol><li><span>O número de referência da syscall sempre é declarado no registrador eax e pode ser consultado no arquivo padrão do seu OS.</span></li><li><span>Os argumentos da syscall devem seguir uma ordem específica e podem ser consultados usando </span><code>man 2 nome_da_sycall</code><span>.</span></li><li><span>Os valores da nossa syscall (como stdin para write) normalmente podem ser percebidos na descrição da syscall, encontrada, também no </span><a href='http://man7.org/linux/man-pages/man2/write.2.html'><span>Linux Programmer&#39;s Manual</span></a><span> ou usando </span><code>man 2 nome_da_sycall</code><span>.</span></li></ol><p><span>Vamos completar o nosso código então! </span><img src="https://nutc4k3.github.io/imgs/cat_code.gif" alt="cat_code"  width="200" height="150" /></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="assembly" style="page-break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="assembly"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 28px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">global</span> <span class="cm-builtin">_start</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">section</span> <span class="cm-builtin">.text</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">_start</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-keyword">mov</span> <span class="cm-variable-2">eax</span>, 4 <span class="cm-comment">; numero de referencia para write</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-keyword">mov</span> <span class="cm-variable-2">ebx</span>, 1 <span class="cm-comment">; queremos o fd == stdout == 1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-keyword">mov</span> <span class="cm-variable-2">ecx</span>, message <span class="cm-comment">; apontamos para nossa label "message" por ser o que queremos alocar no buffer</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-keyword">mov</span> <span class="cm-variable-2">edx</span>, 12 <span class="cm-comment">; count == 12 porque a frase "Hello World" tem 12 chars == 12 bytes</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-keyword">int</span> <span class="cm-keyword">0x80</span> <span class="cm-comment">; chamamos a syscall que encontra-se no eax</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-keyword">mov</span> <span class="cm-variable-2">eax</span>, 1 <span class="cm-comment">; numero de referencia para exit</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-keyword">mov</span> <span class="cm-variable-2">ebx</span>, 5 <span class="cm-comment">; se olharmos no manual veremos que a syscall exit pede por um numero de "status", declaramos como 5</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-keyword">int</span> <span class="cm-keyword">0x80</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">section</span> <span class="cm-builtin">.data</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tag">message:</span> db <span class="cm-string">"Hello World!"</span> </span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 300px;"></div><div class="CodeMirror-gutters" style="display: none; height: 300px;"></div></div></div></pre><p><span>Uhul, estamos quase terminando </span><img src="https://nutc4k3.github.io/imgs/stars.gif" alt="stars"   width="150" height="150"  /></p><p><span>Se você comparar com o código inicial, temos duas diferenças principais:</span></p><ol><li><span>Esse código possui os números em decimal enquanto que o outro em hexa (você pode usar qualquer um, mas escolha um e use ele durante todo código)</span></li><li><span>O registrador edx está com um valor diferente e mlen sumiu.</span></li></ol><p><span>Essa última parte foca principalmente em um mecanismo para facilitar a passagem de bytes para o argumento </span><em><span>count</span></em><span>, nesse caso, alocado no registrador </span><code>edx</code><span>.</span></p><p><span>Hoje estamos literalmente contando cada byte da frase </span><strong><span>&quot;Hello World!&quot;</span></strong><span> e declarando em </span><code>edx</code><span>. Lembre-se que segundo os tipos de dados, cada </span><em><span>char == 1 byte</span></em><span>, assim temos 12 bytes em 12 caracteres da frase. Alias, eu tenho que te contar uma coisa: </span><strong><span>Não existe o tipo de dados &#39;string&#39; em assembly</span></strong><span>, &quot;string&quot; nada mais é do que um &quot;concatenado&quot; de chars em sequência na memória. E como eu posso escrever um código que imprime na tela qualquer que seja a frase, sem ter que ficar contanto byte por byte?</span></p><p><span>Aí entram as </span><a href='https://www.nasm.us/doc/nasmdoc3.html#section-3.5'><span>expressões</span></a><span>. Segundo o manual:</span></p><blockquote><p><span>&quot;O NASM suporta dois tokens especiais como expressões, permitindo que os cálculos envolvam a posição atual do assembly: os tokens </span><code>$</code><span> e </span><code>$$</code><span>. </span><code>$</code><span> avalia para a posição do assembly no início da linha que contém a expressão; para que você possa codificar um loop infinito usando </span><code>JMP $</code><span>. </span><code>$$</code><span> é avaliado no início da seção atual; para que você possa saber onde está em uma seção usando </span><code>($ - $$)</code><span>.&quot;</span></p></blockquote><p><span>Ou seja, $ e $$ são &quot;pontos de referência&quot;, sendo o primeiro para o inicio da linha onde o </span><code>$</code><span> encontra-se e o segundo para o inicio da seção em uso. Se queremos saber o tamanho que a mensagem ocupa, podemos dizer &quot;conte do inicio do primeiro char ate o último&quot; ou podemos dizer &quot;o meu valor é igual a minha localização atual menos a localização da label da mensagem&quot;. Por incrível que pareça, seria um caminho maior seguir com a primeira frase do que a segunda em assembly, por existirem expressões prontas, como é o caso do </span><code>$</code><span>.</span></p><p><span>Desta forma, podemos escrever: </span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="assembly "><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="assembly "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 28px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">mlen</span> &nbsp; &nbsp;<span class="cm-keyword">equ</span> $-message</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 20px;"></div><div class="CodeMirror-gutters" style="display: none; height: 20px;"></div></div></div></pre><p><code>equ</code><span> é a forma como definimos </span><a href='https://www.nasm.us/doc/nasmdoc3.html#section-3.2.4'><span>constantes</span></a><span> em assembly e nesse código acima estamos dizendo &quot;Guarde o valor do resultado da subtração da minha localização atual(</span><code>$</code><span>) menos a localização da label </span><code>message</code><span>, na minha label </span><code>mlen</code><span>&quot;. </span></p><p><span> </span><img src="https://nutc4k3.github.io/imgs/confused.gif" referrerpolicy="no-referrer" alt="confused" width="150" height="150" ></p><p><span>Confuso, eu sei, mas se você pensar na estrutura da memória para esse caso, ambos </span><code>message</code><span> e </span><code>mlen</code><span> encontram-se em sequência na mesma </span><code>section .data</code><span>. O que separa uma label da outra é a frase </span><code>&quot;Hello World!&quot;</code><span>, ocupando, cada char, um byte, totalizando 12 bytes de distância. </span></p><p><span>No próximo post vamos fazer a engenharia reversa desse código. Talvez fique mais fácil entender vendo o comportamento da memória para o nosso programa. Até a próxima :) </span></p><p><span> </span><img src="https://nutc4k3.github.io/imgs/bye_cry.gif" referrerpolicy="no-referrer" alt="bye_cry"   width="200" height="200" ></p><p><em><span>Qualquer dúvida ou correção é só me chamar de boas no twitter </span><a href='https://twitter.com/nutcake7'><span>@nutcake7</span></a></em></p></div>
</body>
</html>